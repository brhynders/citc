function registerClientMethods(n){var i,t=$("#Username").val(),r=$("#UserId").val();n.client.broadcastConnection=function(n,t,r){$("#"+r+"> span").css("color","limegreen");$("#"+r+"> div").css("color","#1963b3");$("#d_ConnId_"+r).attr("value",n);$("#connid_"+r).attr("value",n);$("#groupMemberConnId_"+r).attr("value",n);clearTimeout(i)};n.client.broadcastDisconnection=function(n,t,r){function u(){$("#"+r+"> span").css("color","#bcd8f5");$("#"+r+"> div").css("color","#8fbeef")}i=setTimeout(u,3e3)};n.client.addChatMessage=function(n,i,r,u,f,e,o){var s={ToId:e,FromId:r},h,c;n==t?(h='<div class="d-flex flex-column px-2 py-1 align-self-end megrad mecont"><label class="mb-0">'+n+"<\/label><span>"+o+"<\/span><\/div>",$("#pm_"+e).find("#messageContent").append(h),$(".pmFrame_"+e).scrollTop($(".pmFrame_"+e)[0].scrollHeight)):$("#pm_"+r).length==0&&$(window).width()<768&&window.location.pathname=="/Account/Messages"?(createPrivateChatWindow(n,r),$.ajax({type:"POST",url:"GetHistory",data:JSON.stringify(s),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){for(var i=0,u,f;i<n.length;i++)n[i].FromName==t?(u='<div class="d-flex flex-column px-2 py-1 align-self-end megrad mecont"><label class="mb-0">'+n[i].FromName+"<\/label><span>"+n[i].Message+"<\/span><\/div>",$("#pm_"+r).find("#messageContent").append(u)):(f='<div class="d-flex flex-column px-2 py-1 align-self-start themgrad themcont"><label class="mb-0">'+n[i].FromName+"<\/label><span>"+n[i].Message+"<\/span><\/div>",$("#pm_"+r).find("#messageContent").append(f));$(".pmFrame_"+r).delay(1e3).scrollTop($(".pmFrame_"+r)[0].scrollHeight)}})):$("#pm_"+r).length==0&&$(window).width()>768?(createPrivateChatWindow(n,r),$.ajax({type:"POST",url:"GetHistory",data:JSON.stringify(s),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){for(var i=0,u,f;i<n.length;i++)n[i].FromName==t?(u='<div class="d-flex flex-column px-2 py-1 align-self-end megrad mecont"><label class="mb-0">'+n[i].FromName+"<\/label><span>"+n[i].Message+"<\/span><\/div>",$("#pm_"+r).find("#messageContent").append(u)):(f='<div class="d-flex flex-column px-2 py-1 align-self-start themgrad themcont"><label class="mb-0">'+n[i].FromName+"<\/label><span>"+n[i].Message+"<\/span><\/div>",$("#pm_"+r).find("#messageContent").append(f));$(".pmFrame_"+r).delay(1e3).scrollTop($(".pmFrame_"+r)[0].scrollHeight)}})):(c='<div class="d-flex flex-column px-2 py-1 align-self-start themgrad themcont"><label class="mb-0">'+n+"<\/label><span>"+o+"<\/span><\/div>",$("#pm_"+r).find("#messageContent").append(c),$(".pmFrame_"+r).scrollTop($(".pmFrame_"+r)[0].scrollHeight),$.ajax({type:"POST",url:"SeenMessages",data:JSON.stringify(s),contentType:"application/json; charset=utf-8",dataType:"json"}))};n.client.addGroupChatMessage=function(n,i,r,u){var f,e;n==t?(f='<div class="d-flex flex-column px-2 py-1 align-self-end megrad mecont"><label class="mb-0">'+n+"<\/label><span>"+u+"<\/span><\/div>",$(window).width()<768?($("#m_groupChatId_"+r).append(f),$(".m_groupScroll").scrollTop($(".m_groupScroll")[0].scrollHeight)):($("#d_groupChatId_"+r).append(f),$(".d_groupScroll").scrollTop($(".d_groupScroll")[0].scrollHeight))):(e='<div class="d-flex flex-column px-2 py-1 align-self-start themgrad themcont"><label class="mb-0">'+n+"<\/label><span>"+u+"<\/span><\/div>",$(window).width()<768?($("#m_groupChatId_"+r).append(e),$(".m_groupScroll").scrollTop($(".m_groupScroll")[0].scrollHeight)):($("#d_groupChatId_"+r).append(e),$(".d_groupScroll").scrollTop($(".d_groupScroll")[0].scrollHeight)))}}function registerEvents(n){$(".contactsButton").click(function(){var t;setInterval(function(){toconnid=$(this).find("#thisConnId").attr("value")},1e3);var e=$.connection.chatHub,r=$(this).find("#thisName").text(),n=$(this).attr("id"),u=$("#UserId").attr("value"),f=$("#Username").attr("value"),i="pm_"+n;$("#"+i).length==0&&(createPrivateChatWindow(r,n,i),t={ToId:n,FromId:u},$.ajax({type:"POST",url:"GetHistory",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){for(var i=0,r,u;i<t.length;i++)t[i].FromName==f?(r='<div class="d-flex flex-column px-2 py-1 align-self-end megrad mecont"><label class="mb-0">'+t[i].FromName+"<\/label><span>"+t[i].Message+"<\/span><\/div>",$("#pm_"+n).find("#messageContent").append(r)):(u='<div class="d-flex flex-column px-2 py-1 align-self-start themgrad themcont"><label class="mb-0">'+t[i].FromName+"<\/label><span>"+t[i].Message+"<\/span><\/div>",$("#pm_"+n).find("#messageContent").append(u));$(".pmFrame_"+n).delay(1e3).scrollTop($(".pmFrame_"+n)[0].scrollHeight)}}),$.ajax({type:"POST",url:"SeenMessages",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json"}))});$(".messageContent").click(function(){var r=$(this).find("#thisName").text(),n=$(this).attr("id"),u=$("#UserId").attr("value"),f=$("#Username").attr("value"),i="pm_"+n,t;$("#"+i).length==0&&(createPrivateChatWindow(r,n,i),t={ToId:n,FromId:u},$.ajax({type:"POST",url:"GetHistory",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){for(var i=0,r,u;i<t.length;i++)t[i].FromName==f?(r='<div class="d-flex flex-column px-2 py-1 align-self-end megrad mecont"><label class="mb-0">'+t[i].FromName+"<\/label><span>"+t[i].Message+"<\/span><\/div>",$("#pm_"+n).find("#messageContent").append(r)):(u='<div class="d-flex flex-column px-2 py-1 align-self-start themgrad themcont"><label class="mb-0">'+t[i].FromName+"<\/label><span>"+t[i].Message+"<\/span><\/div>",$("#pm_"+n).find("#messageContent").append(u));$(".pmFrame_"+n).delay(1e3).scrollTop($(".pmFrame_"+n)[0].scrollHeight)}}),$.ajax({type:"POST",url:"SeenMessages",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json"}))});$(".groupSelect").change(function(){var t,e,r,u,i,f;$(".chatGroupMember").remove();$(this).val()!="Select Group"?($("#m_groupsPeopleIcon").css("color","#16579c"),$("groupSelectInner").remove(),currentGroupNumber=$(this).val(),thisGroup=$("#"+currentGroupNumber),groupID=$("#ID_"+currentGroupNumber).val(),t=$("#"+$(thisGroup).attr("id")).find("#groupStatus").attr("value"),$(window).width()<768?(groupChatWindow=$(".m_chatOut").attr("id","m_groupChatId_"+groupID),$("#m_groupsAlertIcon").removeClass("alertGreen alertYellow alertRed"),t=="1"?$("#m_groupsAlertIcon").addClass("alertGreen"):t=="2"?$("#m_groupsAlertIcon").addClass("alertYellow"):t=="3"&&$("#m_groupsAlertIcon").addClass("alertRed")):(groupChatWindow=$(".d_chatOut").attr("id","d_groupChatId_"+groupID),$("#groupStatusButton").removeClass("alertGreen alertYellow alertRed"),t=="1"?($("#groupStatusButton").addClass("alertGreen"),$("#groupStatusButton").text("GROUP STATUS: GREEN")):t=="2"?($("#groupStatusButton").addClass("alertYellow"),$("#groupStatusButton").text("GROUP STATUS: YELLOW")):t=="3"&&($("#groupStatusButton").addClass("alertRed"),$("#groupStatusButton").text("GROUP STATUS: RED"))),n.server.joinRoom(groupID),e=$(thisGroup).find(".groupMemberName").each(function(){var n=$(this).val(),t='<div class="chatGroupMember memberGrad d-flex flex-row justify-content-center align-items-center mt-1"><div class="chatGroupMemberIcon"><span class="ion-person"><\/span><\/div><div class="chatGroupMemberName pl-2" style="">'+n+"<\/div><\/div>";$("#chatGroupMembersContainer").append(t)}),i=$(groupChatWindow).attr("id"),$("#"+i).children().remove(),r={ToGroupId:groupID},u=$("#Username").attr("value"),$.ajax({type:"POST",url:"GetGroupHistory",data:JSON.stringify(r),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){for(var t=0,r,f;t<n.length;t++)n[t].FromName==u?(r='<div class="d-flex flex-column px-2 py-1 align-self-end megrad mecont"><label class="mb-0">'+n[t].FromName+"<\/label><span>"+n[t].Message+"<\/span><\/div>",$("#"+i).append(r)):(f='<div class="d-flex flex-column px-2 py-1 align-self-start themgrad themcont"><label class="mb-0">'+n[t].FromName+"<\/label><span>"+n[t].Message+"<\/span><\/div>",$("#"+i).append(f));$(window).width()<768?$(".m_groupScroll").scrollTop($(".m_groupScroll")[0].scrollHeight):$(".d_groupScroll").scrollTop($(".d_groupScroll")[0].scrollHeight)}})):(currentGroupNumber=$(this).val(),thisGroup=$("#"+currentGroupNumber),groupID=$("#ID_"+currentGroupNumber).val(),i=$(groupChatWindow).attr("id"),$("#"+i).children().remove(),$("#m_groupsAlertIcon").css("color",""),$("#m_groupsPeopleIcon").css("color",""),$("#m_groupsAlertIcon").removeClass("alertGreen alertYellow alertRed"),$("#groupStatusButton").removeClass("alertGreen alertYellow alertRed"),$("#groupStatusButton").text("SELECT A GROUP"),f='<div class="groupSelectInner p-3 d-flex flex-column justify-content-center align-items-center"><div class="groupSelectIcon ion-ios-people-outline"><\/div><div class="groupSelectText">Please select a group from the dropdown menu<\/div><\/div>',$("#"+i).append(f))});$(".groupchatTextInput").keypress(function(n){if(n.which==13){var i=$.connection.chatHub,r=$("#Username").attr("value"),u=$("#UserId").attr("value"),f=groupID,t=$(this).val(),e=$(groupChatWindow).attr("id");t.length>0&&(i.server.sendGroupMessage(r,u,f,t,e),$(this).val(""))}})}function createPrivateChatWindow(n,t,i,r){var e=$.connection.chatHub,u,f;t==null?(u='<div id="pm_'+r+'" class="pmContainer ml-2 maximizechat" ><div id="pmHeader" class="pmHeader d-flex flex-row"><label id="contactName" class="ml-2 w-100">'+i+'<\/label><div class="ion-close ml-auto closeChat"><\/div><\/div><div class="pmFrame_'+r+' pmBody><div id="messageContent" class="messageContent_'+r+' d-flex flex-column justify-content-end"><\/div><\/div><div class="pmFooter"><input id="input_'+r+'" type="text" class="px-2" placeholder="Enter a private message..." /><\/div><\/div>',f=$(u),screen.width<662?($("#bgf").toggleClass("bgfade bgfade-toggle"),$("#pmModal").toggleClass("pmwrapper apmwrappertoggle"),$("#pmModal").append(u)):$("#pmWrapper").append(u)):(u='<div id="pm_'+t+'" class="pmContainer ml-2 maximizechat" ><div id="pmHeader" class="pmHeader d-flex flex-row"><label id="contactName" class="ml-2 w-100">'+n+'<\/label><div class="ion-close ml-auto closeChat"><\/div><\/div><div class="pmFrame_'+t+' pmBody"><div id="messageContent" class="messageContent_'+t+' d-flex flex-column justify-content-end"><\/div><\/div><div class="pmFooter"><input id="input_'+t+'" type="text" class="px-2" placeholder="Enter a private message..." /><\/div><\/div>',f=$(u),screen.width<662?($("#bgf").toggleClass("bgfade bgfade-toggle"),$("#pmModal").toggleClass("pmMobilewrapper pmMobilewrappertoggle"),$("#pmModal").append(u)):$("#pmWrapper").append(u));$(".closeChat").click(function(){$(this).parent(this).parent(this).remove();$("#bgf").removeClass("bgfade-toggle");$("#bgf").addClass("bgfade");$("#pmModal").removeClass("pmMobilewrappertoggle");$("#pmModal").addClass("pmMobilewrapper")});$("#input_"+t).keypress(function(i){var r,h;if(i.which==13){var f=$("#Username").attr("value"),o=$("#UserId").attr("value"),s=$("#UserConnectionId").attr("value"),u;u=screen.width<662?$("#connid_"+t).attr("value"):$("#d_ConnId_"+t).val();r=$(this).val();h={from:f,fromconnid:s,fromid:o,to:n,toconnid:u,toid:t,message:r};console.log(h);r.length>0&&(e.server.sendChatMessage(f,s,o,n,u,t,r),$(this).val(""))}})}var toconnid,currentGroupNumber,thisGroup,groupID,groupChatWindow,me=$("#UserId").attr("value");$(function(){var n=$.connection.chatHub;registerClientMethods(n);n.logging=!0;$.connection.hub.start().done(function(){registerEvents(n)})});